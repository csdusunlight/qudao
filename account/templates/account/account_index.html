{% load staticfiles %}
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>用户中心</title>
<link href="{% static 'images/favicon.ico'%}" rel="shortcut icon"/>
<!--<link rel="stylesheet" type="text/css" href="{% static 'css/User.css' %}" />-->
<link rel="stylesheet" type="text/css" href="{% static 'css/wfl-common.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'css/account-base.css' %}" />
<!--<link rel="stylesheet" type="text/css" href="{% static 'css/style-i.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}" />-->
<script type="text/javascript" src="{% static 'js/jquery-1.11.2.min.js' %}"></script>

</head>

<body>
    	<!--头部-->
{% include "header.html" %}
   	<!--内容-->
<div class="Content">
   	<!--<div class="w1100">-->
			{% include "account/left.html" %}
            <div class="RightCont">
                <div class="notice-index">
                    <h3 class="notice__title">通知栏</h3>
                    <div id="noticeBox" class="notice__box">
                        <ul id="con1">
                            <!--{%for notice in announce_list%}
                                <li><a class="notice__txt oneline">{{forloop.counter}}、{{notice.content}}</a></li>
                            {%endfor%}-->
                            <!--<li><a class="notice__txt oneline">1、这里是通知11111111111111111111这里是通知11111111111111111111这里是通知11111111111111111111这里是通知11111111111111111111这里是通知11111111111111111111这里是通知11111111111111111111</a></li>
                            <li><a class="notice__txt oneline">2、这里是通知22222222222222222222这里是通知222222222222222222这里是通知2222222222222222222</a></li>
                            <li><a class="notice__txt oneline">3、这里是通知33333333333333333这里是通知33333333333333333333333这里是通知33333333333333333</a></li>
                            <li><a class="notice__txt oneline">4、这里是通知4444444444444444这里是通知4444444444444444444444444这里是通知4444</a></li>-->
                        </ul>
                        <!--<ul id="con2">
                        </ul>-->
                    </div>
                    <div class="copy-link">
                        <p class="link-box">我的主页：<a href="http://{{user.qq_number}}.51fanshu.com" target="_blank" class="target-link">http://{{user.qq_number}}.51fanshu.com</a></p>
                        <a id="copy" class="btn m-green m-link">复制链接</a><a style="margin-left: 244px;" href="{% url 'account_setting' %}" class="btn m-green m-link">设置</a>
                    </div>
                </div>
                
                <ul class="benefit">
                    <li class="benefit__item">累计收益（元）<br /><span class="benefit__item-txt">{{user.accu_income}}</span></li>
                    <!--<li class="benefit__item">昨日收益（元）<br /><span class="benefit__item-txt">19999</span></li>-->
                    <li class="benefit__item">账户余额（元）<br /><span class="benefit__item-txt">{{user.balance}}</span></li>
                    <li class="benefit__withdraw"><a href="{% url 'account_withdraw' %}" class="btn m-green">提现</a></li>
                    <div id="main" class="chart" style="width: 600px;height:400px;"></div>
                </ul>
                <div class="recommend">
                    <div class="recommend__titlebox clearfix">
                        <h2 class="recommend__title l">热门推荐</h2>
                        <a class="recommend__more r" href="{% url 'project_all' %}" target="_blank">查看更多>></a>
                    </div>
                    <ul class="recommend__itembox">
                    {% for recom in recom_projects %}
                            <li class="recommend__item"><a href="{{recom.strategy}}" target="_blank">
                                <img class="recommend__img" src="{{recom.picture_url}}" alt="" />
                                <!--<h4 class="recommend__name oneline">{{recom.title}}</h4>
                                <p class="recommend__detail oneline">{{recom.introduction}}</p>
                                <div class="btn-box m-account">
                                    <a href="{{recom.strategy}}" target="_blank" class="btn m-green">查看攻略</a>
                                </div>-->
                            </a></li>
                    {%endfor%}
                    </ul>
                </div>
                
                
            </div>
</div>
{% include "footer.html" %}

<script type="text/javascript" src="{% static 'js/wfl-common.js' %}"></script>
<script type="text/javascript" src="{%static 'js/echarts.common.min.js'%}"></script>
<!--<script type="text/javascript" src="{% static "js/ZeroClipboard.js" %}"></script>-->
<script type="text/javascript" src="{% static 'js/clipboard.min.js' %}"></script>
<script type="text/javascript">
$(function(){
    $('.back-a1').toggleClass("on");
    var con1 = document.getElementById('con1');
    var notice_txt = '';
    $.ajax({
        url: '/restapi/announcement/?ordering=state',
        dataType: "json",
        type: 'get',
        success: function(ret) {
            if (ret.results.length != 0){
                var notice_num = 1;
                for (var i in ret.results) {
                    notice_txt += '<li class="notice__item">';
                    if (ret.results[i].state == 0) {
                        notice_txt += '<span style="color:#f95a5a">【置顶】</span>'
                    } else{
                        notice_txt += '<span>'+ notice_num++ +'</span>、'
                    }
                    notice_txt += ret.results[i].content +'</li>';
                }
            }
            con1.innerHTML = notice_txt;
        },
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR.responseText);
            alert("数据错误");
        }
    });
    
    var clipboard = new Clipboard('#copy', {
        target: function() {
            return document.querySelector('.target-link');
        }
    });

    clipboard.on('success', function(e) {
        console.log(e);
    });

    clipboard.on('error', function(e) {
        console.log(e);
    });
//  var clipboard = new Clipboard('#copy');
//  
//  clipboard.on('success', function(e) {
//      console.log(e);
//  });
//  
//  clipboard.on('error', function(e) {
//      console.log(e);
//  });

//  图表部分
//  获取图表数据
    var chartdata_01;
    var data_x = [0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    var data_y = [0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    $.ajax({
        url:"/restapi/userstatis/?page=1&pageSize=14&user={{user.id}}",
    	type:"get",
    	dataType: "json",
    	success: function(ret) {
    	    chartdata_01 = ret.results;
    	    console.log(ret.results.length);
    	    if (ret.results.length > 0) {
    	        for (var i = 0; i<ret.results.length; i++) {
    	        	data_x[i] = ret.results[i].date.slice(5);
    	        	data_y[i] = ret.results[i].settle_amount;
    	        	console.log('ret.results[i].date')
    	        }
    	    }
    	    console.log(data_x);
    	    console.log(data_y);
    	    //  获取图表数据---end
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('main'));
        //  var data_x = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];
            // 指定图表的配置项和数据
            var option = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    crossStyle: {
                        color: '#999'
                    }
                }
            },
            toolbox: {
                feature: {
                    dataView: {show: true, readOnly: false},
                    magicType: {show: true, type: ['line', 'bar']},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            legend: {
                data:['结算数']
            },
            xAxis: [
                {
                    type: 'category',
//                  data: ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'],
                    data: data_x,
                    axisPointer: {
                        type: 'shadow'
                    }
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: '结算金额',
//                  min: 0,
//                  max: 250,
//                  interval: 50,
                    axisLabel: {
                        formatter: '{value} 元'
                    }
                }
//              {
//                  type: 'value',
//                  name: '温度',
//                  min: 0,
//                  max: 25,
//                  interval: 5,
//                  axisLabel: {
//                      formatter: '{value} °C'
//                  }
//              }
            ],
            color:['#61a0a8', '#2f4554', '#d48265', '#91c7ae','#749f83',  '#ca8622', '#bda29a','#6e7074', '#546570', '#c4ccd3'],
            series: [
                {
                    name:'结算金额',
                    type:'bar',
                    bgcolor: '#ffbe00',
//                  data:[2.0, 4.9, 7.0, 23.2, 25.6, 76.7, 135.6, 162.2, 32.6, 20.0, 6.4, 3.3]
                    data: data_y
                }
        //      {
        //          name:'降水量',
        //          type:'bar',
        //          data:[2.6, 5.9, 9.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3]
        //      },
//              {
//                  name:'平均温度',
//                  type:'line',
//                  yAxisIndex: 1,
//                  data:[2.0, 2.2, 3.3, 4.5, 6.3, 10.2, 20.3, 23.4, 23.0, 16.5, 12.0, 6.2]
//              }
            ]
        };
        
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);
        //  图表部分---end
        },
        error: function() {
            alert("请检查网络连接");
        }
    });


});
//  滚动部分
//  var area = document.getElementById('noticeBox');
//  var con1 = document.getElementById('con1');
//  var con2 = document.getElementById('con2');
//  var speed = 50;
//  area.scrollTop = 0;
//  console.log(area.scrollTop);
//  console.log(con1.scrollTop);
//  if (area.clientHeight > con1.clientHeight) {
//  } else {    
//      con2.innerHTML = con1.innerHTML;
//      function scrollUp(){
//          if(area.scrollTop >= con1.scrollHeight) {
//              area.scrollTop = 0;
//              }else{
//                 area.scrollTop ++;
//              }
//      }
//      var myScroll = setInterval("scrollUp()",speed);
//      area.onmouseover = function(){
//          clearInterval(myScroll);
//      }
//      area.onmouseout = function(){
//          myScroll = setInterval("scrollUp()",speed);
//      }
//  }
//  滚动部分---end 
</script>
</body>
</html>
