{% load staticfiles %}
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>用户中心</title>
<link href="{% static 'images/favicon.ico'%}" rel="shortcut icon"/>
<!--<link rel="stylesheet" type="text/css" href="{% static 'css/User.css' %}" />-->
<!--<link rel="stylesheet" type="text/css" href="{% static 'css/wfl-common.css' %}" />-->
<link rel="stylesheet" type="text/css" href="{% static 'css/account-base.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'ueditor/themes/default/css/umeditor.css' %}" />
<script type="text/javascript" src="{% static 'ueditor/third-party/jquery.min.js' %}"></script>
<script type="text/javascript" src="{% static 'ueditor/third-party/template.min.js' %}"></script>
<script type="text/javascript" src="{% static 'ueditor/umeditor.config.js' %}"></script>
<script type="text/javascript" src="{% static 'ueditor/umeditor.js' %}"></script>
<style>
    body {
        margin: 0;
        padding: 0;
        background-color: #f0f0f0;
        overflow-y: hidden;
    }
    .header {
        position: fixed;
        top: 0;
        left: 0;
        box-sizing: border-box;
        width: 100%;
        height: 52px;
        background-color: #fff;
        z-index: 10000;
        border-bottom: 1px solid #e4e4e4;
    }
    .header.m-shadow {
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        border-bottom: none;
    }
    .container {
        position: fixed;
        width: 100%;
        top: 0;
        bottom: 0;
        /*height: 800px;*/
        margin: 52px auto 0;
        overflow-y: auto;
    }
    .proj__title-box {
        position: absolute;
        top: 110px;
        left: 0;
        width: 100%;
        z-index: 100;
    }
    .proj__title {
        display: block;
        padding-top: 10px;
        margin: 0 auto;
        width: 600px;
        height: 50px;
        line-height: 50px;
        border: none;
        outline: none;
        color: #333;
        font-size: 30px;
        font-weight: 700;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        border-bottom: 1px solid #e4e4e4;
        background-color: transparent;
    }
    .footer {
        width: 800px;
        margin: 0 auto;
        height: 50px;
        /*background-color: #fff;*/
    }
    /*样式覆盖*/
    .edui-container {
        position: static;
        margin: 0 auto;
    }
    .edui-container .edui-toolbar {
        padding-top: 6px;
        z-index: 999;
        transition: padding 0.3s ease-in; 
    }
    .edui-container .edui-toolbar.m-top {
        /*position: fixed;*/
        left: 0;
        padding-bottom: 6px;
        width: 100% !important;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        z-index: 10000 !important;
    }
    .dropdown-menu {
        top: -6px !important;
        width: 105px;
        box-sizing: border-box;
    }
    /*.dropdown-menu:before {
        content: "";
        position: absolute;
        top: -8px;
        left: 20px;
        width: 10px;
        height: 10px;
        transform: rotate(45deg);
        background-color: #fff;
        border-top: 1px solid #ccc;
        border-left: 1px solid #ccc;
        z-index: 1;
    }*/
    .edui-dialog-container {
        position: relative;
        width: 800px;
        margin: 0 auto;
    }
    .edui-toolbar.m-top .edui-btn-toolbar {
        width: 816px;
    }
    .edui-btn-toolbar {
        width: 800px;
        margin: 0 auto;
        box-sizing: border-box;
    }
    .edui-container,
    .edui-container .edui-toolbar {
        border: none;
        box-shadow: none;
        background-color: #f0f0f0;
    }
    .edui-toolbar .edui-btn-toolbar {
        /*padding-left: 60px;*/
    }
    .edui-editor-body {
        /*padding-top: 160px;*/
        box-shadow: 0 0px 8px rgba(0,0,0,0.1);
        border-radius: 6px;
    }
    .edui-combobox .edui-button-label {
        width: auto;
    }
    .edui-combobox-menu {
        min-width: 0;
    }
    .edui-combobox-menu .edui-combobox-item .edui-combobox-icon {
        display: inline;
    }
</style>
</head>

<body>
    <div class="header">这里是头部</div>
    <div class="container">
        <div style="position: relative; width: 800px; margin: 0 auto;">
            
            <div class="proj__title-box">
                <input class="proj__title" type="text" name="" id="" value="{{doc.title}}" placeholder="无标题" />
            </div>
            <!--style给定宽度可以影响编辑器的最终宽度-->
            <script type="text/plain" id="myEditor" style="width:800px;height:1000px;padding: 140px 100px 50px;">
                {{doc.content|safe}}
            </script>
        </div>
        <div style="text-align: center;"><a class="save_btn">保存</a></div>
        <div class="footer">编写于番薯文档</div>
    </div>

<script type="text/javascript">
    var doc_id = "{{doc.id}}";
    console.log(doc_id);
    //实例化编辑器
    var um = UM.getEditor('myEditor', {
        toolbar:[
            'undo redo | bold italic underline strikethrough | forecolor backcolor | removeformat |',
            'insertorderedlist insertunorderedlist | selectall cleardoc | paragraph fontfamily fontsize' ,
            '| justifyleft justifycenter justifyright justifyjustify |',
            'link unlink | image ',
            '| horizontal'
        ]
    });
    if ($('.proj__title').val() == '') {
    	$('.proj__title').val('无标题');
    }
    $('.proj__title').focus(function(){
        if ($(this).val() == '无标题') {
        	$(this).val('');
        }
    })
    $('.proj__title').blur(function(){
        if ($(this).val() == '') {
            $(this).val('无标题');
        }
    })
    
    $('.save_btn').click(function(){
        var title = $('.proj__title').val();
        var content = UM.getEditor('myEditor').getContent();
        $.ajax({            //保存文档
            url: "/restapi/docs/" + doc_id + "/",
            dataType: "json",
            type: 'put',
            data: {
                'title': title,
                'content': content, 
            },
            success: function(ret) {
                alert('保存成功');
            },
            error: function(jqXHR, textStatus, errorThrown) {
                console.log(jqXHR.responseText);
                console.log("数据错误");
            }
        });
    })
</script>

</body>
</html>
